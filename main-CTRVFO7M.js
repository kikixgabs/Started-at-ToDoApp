import{$b as _e,Ab as k,Da as b,E as ne,Ea as O,Fb as Se,Gb as ye,Hb as v,I as s,Ib as q,Jb as B,Kb as H,La as w,Lb as S,Na as l,Nb as J,Oa as x,Ob as Ce,P as ae,Pa as c,Pb as Z,Q as R,Qb as xe,Ub as $,Vb as P,Wa as de,Z as i,_a as M,a as oe,ac as Fe,b as ie,ha as g,ib as ue,j as N,kb as ce,lb as ge,mb as fe,na as le,oa as f,ob as he,pa as h,pb as ve,qb as j,rb as E,sb as G,ta as d,u as te,ua as n,ub as z,va as a,wa as u,wb as be,xa as se,xb as _,ya as me,yb as U,za as pe,zb as we}from"./chunk-KFY254FQ.js";var F=class r{_loading=R(!1);loading=this._loading.asReadonly();show(){this._loading.set(!0)}hide(){this._loading.set(!1)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ne({token:r,factory:r.\u0275fac,providedIn:"root"})};function Le(r,o){r&1&&(se(0,"div",0),pe(1,"div",1),me())}var K=class r{loadingService=s(F);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-loading-spinner"]],decls:1,vars:1,consts:[[1,"fixed","inset-0","bg-black/40","backdrop-blur-sm","flex","items-center","justify-center","z-[9999]"],[1,"w-16","h-16","border-4","border-white","border-t-transparent","rounded-full","animate-spin"]],template:function(t,e){t&1&&f(0,Le,2,0,"div",0),t&2&&h(e.loadingService.loading()?0:-1)},encapsulation:2})};function Ne(r,o){r&1&&u(0,"app-loading-spinner")}function Re(r,o){r&1&&u(0,"router-outlet")}var Q=class r{title=R("nagular-tailwind-postcss");lang=s(_);theme=s(U);authService=s(k);router=s(E);loading=R(!0);async ngOnInit(){try{if(await Promise.all([this.lang.initLanguage(),this.theme.init()]),localStorage.getItem("rememberMe")==="true")try{await this.authService.checkSession(),this.router.navigate(["/app"]);return}catch{this.authService.logoutLocal()}}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-root"]],decls:2,vars:1,template:function(t,e){t&1&&f(0,Ne,1,0,"app-loading-spinner")(1,Re,1,0,"router-outlet"),t&2&&h(e.loading()?0:1)},dependencies:[j,K],encapsulation:2})};function De(r,o){if(r&1&&(n(0,"small",1),l(1),a()),r&2){let t=O();i(),x(t.errorMessage())}}var L=class r{control=M.required();label=M.required();type=M.required();placeholder=M.required();errorMessage=M.required();static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-custom-input"]],inputs:{control:[1,"control"],label:[1,"label"],type:[1,"type"],placeholder:[1,"placeholder"],errorMessage:[1,"errorMessage"]},decls:5,vars:5,consts:[[3,"formControl","type"],[1,"error"]],template:function(t,e){t&1&&(n(0,"div")(1,"label"),l(2),a(),u(3,"input",0),f(4,De,2,1,"small",1),a()),t&2&&(i(2),c(" ",e.label()," "),i(),d("formControl",e.control())("type",e.type()),le("placeholder",e.placeholder()),i(),h(e.control().invalid&&e.control().touched?4:-1))},dependencies:[P,ye,q,Ce],styles:["label[_ngcontent-%COMP%]{display:block;font-size:.9rem;color:#3f3f46;margin-bottom:.3rem;font-weight:500}[_ngcontent-%COMP%]::placeholder{color:#afafb6}input[_ngcontent-%COMP%]{width:100%;padding:.7rem .9rem;border:2px solid #e4e4e7;border-radius:.75rem;font-size:.95rem;color:#18181b;outline:none;transition:all .2s}input[_ngcontent-%COMP%]:focus{border-color:#2563eb;box-shadow:0 0 0 2px #2563eb33}.error[_ngcontent-%COMP%]{color:#dc2626;font-size:.8rem;margin-top:.2rem;display:block}"]})};var W=class r{authService=s(k);router=s(E);userPreference=s(be);languageService=s(_);themeService=s(U);loadingService=s(F);localManager=s(we);ngOnInit(){this.loginForm.patchValue({rememberMe:localStorage.getItem("rememberMe")==="true"})}loginForm=new H({email:new S("",{nonNullable:!0,validators:[v.email,v.required]}),password:new S("",{nonNullable:!0,validators:[v.required]}),rememberMe:new S(!1,{nonNullable:!0})});async onSubmit(){if(!this.loginForm.invalid){this.loadingService.show();try{await N(this.authService.login(this.loginForm.getRawValue()));let o=await this.userPreference.getPreferences();o.preferredLanguage?await this.languageService.setLanguage(o.preferredLanguage):await this.languageService.setLanguage("en"),o.preferredTheme?await this.themeService.setTheme(o.preferredTheme):await this.themeService.setTheme("system"),this.loginForm.value.rememberMe?this.localManager.rememberUser():this.localManager.deleteRememberMe(),this.router.navigate(["/app"])}catch(o){console.error("Error en login:",o)}finally{this.loginForm.patchValue({email:"",password:""}),this.loadingService.hide()}}}guestLogin(){this.authService.loginAsGuest(),this.router.navigate(["/app"])}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-login"]],decls:23,vars:13,consts:[[1,"flex","items-center","justify-center","bg-gradient-to-br","from-orange-500","via-orange-400","to-amber-300"],[1,"bg-white/90","shadow-2xl","p-8","w-full","max-w-md","space-y-6"],[1,"text-center"],[1,"text-2xl","font-semibold","text-zinc-800"],[1,"text-zinc-500","text-sm","mt-1"],[1,"flex","flex-col","space-y-5",3,"ngSubmit","formGroup"],["placeholder","john@doe.com","type","email","errorMessage","Must be a valid email",3,"label","control"],["placeholder","johndoe123.","type","password","errorMessage","Invalid password",3,"label","control"],[1,"flex","gap-1"],["type","checkbox","formControlName","rememberMe",1,"cursor-pointer","font-medium","py-2.5"],[1,"text-black"],["type","submit",1,"w-full","bg-blue-600","text-white","font-medium","py-2.5","rounded-xl","shadow","hover:bg-blue-700","active:scale-[0.98]","transition","disabled:bg-zinc-400","disabled:cursor-not-allowed",3,"disabled"],["type","button",1,"bg-blue-400","w-full","cursor-pointer","text-white","font-medium","py-2.5","rounded-xl","shadow-xl","hover:bg-blue-500","hover:scale-102","transition",3,"click"],[1,"text-center","text-sm","text-zinc-500"],["routerLink","/register",1,"text-blue-600","cursor-pointer","hover:underline"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),l(4),a(),n(5,"p",4),l(6),a()(),n(7,"form",5),b("ngSubmit",function(){return e.onSubmit()}),u(8,"app-custom-input",6)(9,"app-custom-input",7),n(10,"div",8),u(11,"input",9),n(12,"div",10),l(13),a()(),n(14,"button",11),l(15),a()(),n(16,"div")(17,"button",12),b("click",function(){return e.guestLogin()}),l(18),a()(),n(19,"div",13),l(20),n(21,"a",14),l(22),a()()()()),t&2&&(i(4),c("",e.languageService.t("login.title")," \u{1F44B}"),i(2),x(e.languageService.t("login.subtitle")),i(),d("formGroup",e.loginForm),i(),d("label",e.languageService.t("login.email"))("control",e.loginForm.get("email")),i(),d("label",e.languageService.t("login.password"))("control",e.loginForm.get("password")),i(4),x(e.languageService.t("login.rememberMe")),i(),d("disabled",e.loginForm.invalid),i(),c(" ",e.languageService.t("login.login")," "),i(3),c(" ",e.languageService.t("login.guest")," "),i(2),c(" ",e.languageService.t("login.goRegist")," "),i(2),x(e.languageService.t("login.register")))},dependencies:[$,J,Se,q,B,P,Z,xe,G,L],encapsulation:2})};function Ee(){return r=>{let o=r.value??"";if(!o)return{required:!0};let t=o.length>=8,e=/[a-zA-Z]/.test(o),m=/\d/.test(o),p=/[!@#$%^&*(),.?":{}|<>]/.test(o);return t&&e&&m&&p?null:{weakPassword:{hasMinLength:t,hasLetter:e,hasNumber:m,hasSymbol:p}}}}function ke(r,o){return t=>{let e=t,m=e.get(r)?.value,p=e.get(o)?.value;return m===p?null:{passwordsMismatch:!0}}}function Te(r,o){r&1&&(n(0,"p",8),l(1,"Checking email availability"),a())}function Ae(r,o){r&1&&(n(0,"p",9),l(1,"This email is already registered \u274C"),a())}function Ve(r,o){if(r&1&&(n(0,"div",12)(1,"p",17)(2,"span"),l(3," \u2705 "),a(),l(4," Minimum 8 characters "),a(),n(5,"p",17)(6,"span"),l(7," \u2705 "),a(),l(8," Contains letters "),a(),n(9,"p",17)(10,"span"),l(11," \u2705 "),a(),l(12," Contains numbers "),a(),n(13,"p",17)(14,"span"),l(15," \u2705 "),a(),l(16," Contains symbols "),a()()),r&2){let t,e,m,p,y,T,A,V,C=O();i(),w("text-green-600",(t=C.registerForm.get("password"))==null||t.errors==null||t.errors.weakPassword==null?null:t.errors.weakPassword.hasMinLength),i(),w("hidden",!(!((e=C.registerForm.get("password"))==null||e.errors==null||e.errors.weakPassword==null)&&e.errors.weakPassword.hasMinLength)),i(3),w("text-green-600",(m=C.registerForm.get("password"))==null||m.errors==null||m.errors.weakPassword==null?null:m.errors.weakPassword.hasLetter),i(),w("hidden",!(!((p=C.registerForm.get("password"))==null||p.errors==null||p.errors.weakPassword==null)&&p.errors.weakPassword.hasLetter)),i(3),w("text-green-600",(y=C.registerForm.get("password"))==null||y.errors==null||y.errors.weakPassword==null?null:y.errors.weakPassword.hasNumber),i(),w("hidden",!(!((T=C.registerForm.get("password"))==null||T.errors==null||T.errors.weakPassword==null)&&T.errors.weakPassword.hasNumber)),i(3),w("text-green-600",(A=C.registerForm.get("password"))==null||A.errors==null||A.errors.weakPassword==null?null:A.errors.weakPassword.hasSymbol),i(),w("hidden",!(!((V=C.registerForm.get("password"))==null||V.errors==null||V.errors.weakPassword==null)&&V.errors.weakPassword.hasSymbol))}}function Oe(r,o){r&1&&(n(0,"p",13),l(1,"Passwords do not match \u274C"),a())}var X=class r{authService=s(k);router=s(E);lang=s(_);loadingService=s(F);constructor(){this.registerForm.get("email")?.valueChanges.pipe(te(500)).subscribe(()=>this.checkEmail())}ngOnInit(){this.registerForm.get("email")?.valueChanges.pipe(te(500)).subscribe(()=>this.checkEmail())}registerForm=new H({username:new S("",{nonNullable:!0,validators:[v.required,v.minLength(3)]}),email:new S("",{nonNullable:!0,validators:[v.required,v.email]}),password:new S("",{nonNullable:!0,validators:[v.required,Ee()]}),confirmPassword:new S("",{nonNullable:!0,validators:[v.required]})},{validators:ke("password","confirmPassword")});async onSubmit(){if(this.registerForm.valid){this.loadingService.show();try{let o=await N(this.authService.register(this.registerForm.getRawValue()));this.router.navigate(["/login"])}catch(o){console.error("\u274C Error en el registro:",o)}finally{this.loadingService.hide()}}else this.registerForm.markAllAsTouched()}emailInUse=!1;checkingEmail=!1;onEmailBlur(){this.checkEmail(!0)}async checkEmail(o=!1){let t=this.registerForm.get("email"),e=t?.value;if(!e||t?.invalid){this.emailInUse=!1;return}if(!(!o&&!t?.dirty)){this.checkingEmail=!0,this.emailInUse=!1;try{let m=await N(this.authService.checkEmail(e));this.emailInUse=m.inUse}catch{}this.checkingEmail=!1}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-register"]],decls:22,vars:21,consts:[[1,"flex","items-center","justify-center","bg-gradient-to-br","from-orange-500","via-orange-400","to-amber-300"],[1,"bg-white/90","backdrop-blur-md","shadow-2xl","p-8","w-[24rem]","md:w-[28rem]","flex","flex-col","gap-6"],[1,"text-center"],[1,"text-3xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500","mt-1"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],["placeholder","John Doe","type","text","errorMessage","Enter a valid username",3,"label","control"],["placeholder","John@Doe.com","type","email","errorMessage","Enter a valid email",3,"blur","label","control"],[1,"text-sm","text-orange-600"],[1,"text-sm","text-red-600"],["type","password","errorMessage","Enter a valid password",3,"label","control","placeholder"],["type","password","errorMessage","Passwords do not match",3,"label","control","placeholder"],[1,"text-sm","text-gray-600","mt-2","space-y-1"],[1,"text-red-600","text-sm","mt-1"],["type","submit",1,"bg-orange-500","hover:bg-orange-600","disabled:opacity-60","text-white","font-medium","py-2.5","rounded-xl","shadow","transition-colors","duration-200",3,"disabled"],[1,"text-center","text-sm","text-gray-500"],["routerLink","/login",1,"text-orange-600","hover:text-orange-700","font-medium","transition-colors","duration-200"],[1,"flex","items-center","gap-1"]],template:function(t,e){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),l(4),a(),n(5,"p",4),l(6),a()(),n(7,"form",5),b("ngSubmit",function(){return e.onSubmit()}),u(8,"app-custom-input",6),n(9,"app-custom-input",7),b("blur",function(){return e.onEmailBlur()}),a(),f(10,Te,2,0,"p",8),f(11,Ae,2,0,"p",9),u(12,"app-custom-input",10)(13,"app-custom-input",11),f(14,Ve,17,16,"div",12),f(15,Oe,2,0,"p",13),n(16,"button",14),l(17),a()(),n(18,"p",15),l(19),n(20,"a",16),l(21),a()()()()),t&2){let m,p,y;i(4),c(" ",e.lang.t("register.title")," \u2728 "),i(2),c(" ",e.lang.t("register.subtitle")," "),i(),d("formGroup",e.registerForm),i(),d("label",e.lang.t("register.username"))("control",e.registerForm.get("username")),i(),d("label",e.lang.t("register.email"))("control",e.registerForm.get("email")),i(),h(e.checkingEmail?10:-1),i(),h(e.emailInUse&&((m=e.registerForm.get("email"))!=null&&m.valid)?11:-1),i(),d("label",e.lang.t("register.password"))("control",e.registerForm.get("password"))("placeholder",e.lang.t("register.password")),i(),d("label",e.lang.t("register.confirmPassword"))("control",e.registerForm.get("confirmPassword"))("placeholder",e.lang.t("register.password")),i(),h((p=e.registerForm.get("password"))!=null&&p.touched&&(!((p=e.registerForm.get("password"))==null||p.errors==null)&&p.errors.weakPassword)?14:-1),i(),h(e.registerForm.errors!=null&&e.registerForm.errors.passwordsMismatch&&((y=e.registerForm.get("confirmPassword"))!=null&&y.touched)?15:-1),i(),d("disabled",e.registerForm.invalid),i(),c(" ",e.lang.t("register.register")," "),i(2),c(" ",e.lang.t("register.goLogin")," "),i(2),c(" ",e.lang.t("register.login")," ")}},dependencies:[$,J,B,P,Z,G,L],encapsulation:2})};var Y=class r{lang=s(_);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=g({type:r,selectors:[["app-authlayout-component"]],decls:16,vars:1,consts:[[1,"flex","items-center","justify-center","min-h-screen","bg-gradient-to-tl","from-blue-600","via-zinc-600","to-orange-400","cursor-default"],[1,"m-3","bg-white/90","backdrop-blur-md","shadow-2xl","rounded-3xl","p-6","w-[24rem]","md:w-[28rem]","flex","flex-col","transition-all"],[1,"text-center"],[1,"flex","w-full","justify-end","gap-4"],[1,"text-zinc-800","cursor-pointer","mb-2","underline",3,"click"],[1,"text-4xl","font-bold","tracking-tight","text-orange-400"],[1,"text-zinc-400"],[1,"text-sm","text-gray-500","mt-1"],[1,"mt-4"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),b("click",function(){return e.lang.setLanguage("en")}),l(5," English "),a(),n(6,"div",4),b("click",function(){return e.lang.setLanguage("es")}),l(7," Espa\xF1ol "),a()(),n(8,"h1",5),l(9," Reddot"),n(10,"span",6),l(11,"Tasks"),a()(),n(12,"p",7),l(13),a()(),n(14,"div",8),u(15,"router-outlet"),a()()()),t&2&&(i(13),x(e.lang.t("authLayout.subtitle")))},dependencies:[j],encapsulation:2})};var Pe=[{path:"",component:Y,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:W},{path:"register",component:X}]}];var ee=[{path:"",children:Pe},{path:"app",loadChildren:()=>import("./chunk-O3S4G2L5.js").then(r=>r.PRIVATE_ROUTES)},{path:"**",redirectTo:""}];var Ie=(r,o)=>{let t=localStorage.getItem("token");if(t){let e=r.clone({setHeaders:{Authorization:`Bearer ${t}`},withCredentials:!0});return o(e)}return o(r)};var re={providers:[ae(),ce(fe(),ge([Ie])),de(),z(ee),ve(he())]};ue(Q,ie(oe({},re),{providers:[...re.providers||[],z(ee),Fe(_e())]})).catch(r=>console.error(r));
